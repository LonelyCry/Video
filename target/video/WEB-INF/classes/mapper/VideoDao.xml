<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.ghe.video.dao.VideoDao">
    <select id="queryTotal" resultType="Integer">
        select count(id)
        from video
    </select>

    <select id="queryVideo" resultType="cn.ghe.video.bean.VideoDO">
        select id,name,order_num as ordernum,
            duration,upload_time as uploadtime,create_time as createtime
        from video
        limit ${start_num},${pageSize}
    </select>
    
    <insert id="addVideo" useGeneratedKeys="true" keyProperty="id" keyColumn="id" parameterType="cn.ghe.video.bean.FileEntity">
        insert into
        video(name,order_num,duration,upload_time,create_time,file_url)
        value(#{name},#{order_num},#{duration},#{uploadTime},#{uploadTime},#{path})
    </insert>

    <update id="updateVideo" parameterType="cn.ghe.video.bean.VideoDO">
        update video
            <set>
                <if test="name!=null">name=#{name},</if>
                <if test="order_num!=null">order_num=#{order_num},</if>
                <if test="file_url!=null">file_url=#{file_url}</if>
            </set>
        where id = #{id}
    </update>

    <!--清空操作和单条视频删除-->
    <delete id="deleteVideo">
        delete from
        video
        where id = #{id}
    </delete>

    <!--清空操作和单条视频删除-->
    <delete id="emptyVideo">
        delete from
        video
    </delete>

    <delete id="deleteBatchVideo" parameterType="java.util.List">
        delete from video where 1>2 or id in
        <foreach collection="list"  item="item" open="(" separator="," close=")" >
            #{item}
        </foreach>
    </delete>

    <select id="playVideo" resultType="cn.ghe.video.bean.VideoDO">
        select id,name,order_num,duration,upload_time
        from video where 1 = 1 id in
        <foreach collection="list"  item="item" open="(" separator="," close=")" >
            #{item}
        </foreach>
    </select>
</mapper>